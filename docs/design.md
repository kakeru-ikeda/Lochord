# Lochord è¨­è¨ˆæ›¸ï¼ˆPhase1ï¼‰

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

| é …ç›® | å†…å®¹ |
|---|---|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå | Lochord |
| ã‚³ãƒ³ã‚»ãƒ—ãƒˆ | ãƒ­ãƒ¼ã‚«ãƒ«éŸ³æ¥½ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®M3U8ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’GUIã§ç®¡ç†ã™ã‚‹ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒª |
| å¯¾è±¡OSï¼ˆPhase1ï¼‰ | Windows / macOS / Linux |
| å°†æ¥å¯¾å¿œï¼ˆPhase2ï¼‰ | iOS / Androidï¼ˆTauri v2ã§å¯¾å¿œå¯èƒ½ï¼‰ |

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | ç”¨é€” |
|---|---|---|
| ã‚¢ãƒ—ãƒªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Tauri v2 | ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªåŸºç›¤ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | React + TypeScript | UIå®Ÿè£… |
| UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | shadcn/ui | ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ  |
| çŠ¶æ…‹ç®¡ç† | Zustand | ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç† |
| ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— | dnd-kit | æ›²ã®ä¸¦ã³æ›¿ãˆãƒ»è¿½åŠ  |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | Rust | ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œ |
| ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå½¢å¼ | M3U8ï¼ˆUTF-8ï¼‰ | å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ |

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã™ã‚‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer          â”‚  â† React Components / Pages
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Application Layer          â”‚  â† Zustand Store / Use Cases
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Domain Layer               â”‚  â† Types / Entities / Rules
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Infrastructure Layer         â”‚  â† Tauri invoke / Rust Commands
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ä¾å­˜ã®æ–¹å‘: Presentation â†’ Application â†’ Domain â† Infrastructure

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ PlaylistPanel/
â”‚   â”‚   â”œâ”€â”€ TrackList/
â”‚   â”‚   â””â”€â”€ LibraryBrowser/
â”‚   â””â”€â”€ pages/
â”‚       â”œâ”€â”€ MainPage.tsx
â”‚       â””â”€â”€ OnboardingPage.tsx
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ useLochordStore.ts
â”‚   â””â”€â”€ usecases/
â”‚       â”œâ”€â”€ scanLibrary.ts
â”‚       â”œâ”€â”€ loadPlaylist.ts
â”‚       â””â”€â”€ savePlaylist.ts
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”œâ”€â”€ Track.ts
â”‚   â”‚   â””â”€â”€ Playlist.ts
â”‚   â””â”€â”€ rules/
â”‚       â””â”€â”€ m3uPathResolver.ts
â””â”€â”€ infrastructure/
    â”œâ”€â”€ tauri/
    â”‚   â”œâ”€â”€ fileSystemAdapter.ts
    â”‚   â””â”€â”€ m3uAdapter.ts
    â””â”€â”€ repositories/
        â”œâ”€â”€ IPlaylistRepository.ts
        â””â”€â”€ PlaylistRepository.ts

src-tauri/
â””â”€â”€ src/
    â”œâ”€â”€ commands/
    â”‚   â”œâ”€â”€ fs.rs
    â”‚   â””â”€â”€ m3u.rs
    â””â”€â”€ main.rs
```

## Rustã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| ã‚³ãƒãƒ³ãƒ‰å | å¼•æ•° | æˆ»ã‚Šå€¤ | å‡¦ç† |
|---|---|---|---|
| `select_music_root` | ãªã— | `String` | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚° |
| `scan_music_directory` | `path: String` | `Vec<Track>` | éŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆå¯¾è±¡æ‹¡å¼µå­: flac, mp3, aac, wav, m4aï¼‰ |
| `list_playlists` | `root: String` | `Vec<String>` | Playlists/é…ä¸‹ã®M3U8ä¸€è¦§ |
| `load_playlist` | `path: String` | `Vec<Track>` | M3U8ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ãƒˆãƒ©ãƒƒã‚¯ä¸€è¦§ |
| `save_playlist` | `path: String, tracks: Vec<Track>` | `bool` | M3U8ã¨ã—ã¦æ›¸ãå‡ºã— |
| `delete_playlist` | `path: String` | `bool` | M3U8ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ |

## Trackå‹å®šç¾©

```typescript
export type Track = {
    title: string;
    artist: string;
    duration: number;      // ç§’
    relativePath: string;  // M3U8ã«æ›¸ãç›¸å¯¾ãƒ‘ã‚¹
    absolutePath: string;  // UIæ“ä½œç”¨ã®çµ¶å¯¾ãƒ‘ã‚¹
};
```

## Playlistå‹å®šç¾©

```typescript
export type Playlist = {
    name: string;
    path: string;   // M3U8ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹
    tracks: Track[];
};
```

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼ˆé‹ç”¨ï¼‰

```
Music/                          â† ãƒ«ãƒ¼ãƒˆï¼ˆã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«æŒ‡å®šï¼‰
â”œâ”€â”€ Playlists/                  â† M3U8ç½®ãå ´
â”‚   â”œâ”€â”€ ãŠæ°—ã«å…¥ã‚Š.m3u8
â”‚   â””â”€â”€ ä½œæ¥­ç”¨BGM.m3u8
â”œâ”€â”€ Artist - Album (Year) [format]/
â”‚   â”œâ”€â”€ 01. TrackTitle.flac
â”‚   â””â”€â”€ 02. TrackTitle.flac
â””â”€â”€ ...
```

M3U8ã®ç›¸å¯¾ãƒ‘ã‚¹ä¾‹ï¼ˆPlaylists/ ã‹ã‚‰ ../ï¼‰:
```
#EXTM3U
#EXTINF:253,Artist - Title
../Artist - Album (Year) [16B-44.1kHz]/01. Title.flac
```

## ç”»é¢æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸµ Lochord                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Playlists    â”‚  [ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå]              [ä¿å­˜] â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  #  â”‚ ã‚¿ã‚¤ãƒˆãƒ«             â”‚ æ™‚é–“    â”‚
â”‚ playlist1    â”‚  1  â”‚ Track A              â”‚ 4:13   â”‚
â”‚ playlist2    â”‚  2  â”‚ Track B              â”‚ 3:49   â”‚
â”‚              â”‚     â”‚ â†• ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—   â”‚        â”‚
â”‚ [+ æ–°è¦ä½œæˆ] â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‚ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª  [Music/]                              â”‚
â”‚  ğŸ“ Artist - Album (2025)                           â”‚
â”‚    ğŸµ 01. Track A              4:13    [+]          â”‚
â”‚    ğŸµ 02. Track B              3:24    [+]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é–‹ç™ºã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase1ï¼‰

```
Step 1  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆTauri v2 + React + TypeScript + shadcn/uiï¼‰
Step 2  Musicãƒ«ãƒ¼ãƒˆé¸æŠï¼ˆselect_music_root ã‚³ãƒãƒ³ãƒ‰ + ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ï¼‰
Step 3  ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¹ã‚­ãƒ£ãƒ³ãƒ»è¡¨ç¤ºï¼ˆscan_music_directory + LibraryBrowserï¼‰
Step 4  ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆä½œæˆãƒ»ä¿å­˜ï¼ˆsave_playlist / list_playlists + å·¦ãƒšã‚¤ãƒ³ï¼‰
Step 5  æ›²ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆï¼ˆdnd-kitï¼‰
Step 6  æ—¢å­˜M3U8ã®èª­ã¿è¾¼ã¿ï¼ˆload_playlistï¼‰
Step 7  UIãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```
